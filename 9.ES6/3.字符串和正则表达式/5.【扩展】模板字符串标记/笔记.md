# 【扩展】模板字符串标记

在模板字符串书写之前，可以加上标记：

```js
//标记名`模板字符串`;
const love1 = "顾昀";
const love2 = "长庚";
//希望对字符串进行简单的处理再拼接
const text = myTag`顾昀行到水穷处最大的慰藉是${love2}
长庚乌尔骨的尽头也只有一个${love1}`;
function myTag(parts) {
  console.log(arguments);
  const values = Array.prototype.slice.call(arguments, 1);
  // const values = Array.from(arguments).slice(1);
  let str = "";
  //parts.length = values.length + 1
  for (var i = 0; i < values.length; i++) {
    str += parts[i] + values[i];
    if (i === values.length - 1) {
      str += parts[values.length];
    }
  } //模拟模板字符串的拼接过程
  return str;
}
console.log(text);
```

标记是一个函数，函数参数如下：

1. 参数 1：被插值分割的字符串数组
2. 后续参数：所有的插值

模板字符串提供好的代表特殊功能的标记：
1. ```String.raw```。模板字符串内的任何内容都会实际表现出来，比如转义符等

```html
<!--示例：保证插值表达式全部以实际的内容显示出来，不会出现元素乱串等的情况-->
<p>
  <textarea id="txt"></textarea>
  <button id="btn">设置div的内容</button>
</p>
<div id="container"></div>
<script>
  const container = document.getElementById("container");
  const txt = document.getElementById("txt");
  const btn = document.getElementById("btn");
  btn.onclick = function () {
    container.innerHTML = safe`<p>${txt.value}</p>`;
  };
  function safe(parts) {
    const values = Array.prototype.slice.call(arguments, 1);
    let str = "";
    for (let i = 0; i < values.length; i++) {
      const v = values[i].replace(/</g, "&lt;").replace(/>/g, "&gt;");
      str += parts[i] + v;
      if (i === values.length - 1) {
        str += parts[values.length];
      }
    }
    return str;
  }
</script>
```